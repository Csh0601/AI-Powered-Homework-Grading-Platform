

 ğŸ“š ä¸€ã€åŠŸèƒ½æ¦‚è¿°

### 1.1 åŠŸèƒ½ç®€ä»‹
è¯•å·ç”ŸæˆåŠŸèƒ½å…è®¸ç”¨æˆ·ä»å†å²æ‰¹æ”¹è®°å½•ä¸­è‡ªåŠ¨æå–ç›¸ä¼¼é¢˜ç›®ï¼Œç”ŸæˆPDFæ ¼å¼çš„ç»ƒä¹ è¯•å·ï¼Œæ–¹ä¾¿æ‰“å°å’Œç»ƒä¹ ã€‚è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„å‰åç«¯äº¤äº’åŠŸèƒ½ï¼Œæ¶‰åŠæ•°æ®è·å–ã€UIå±•ç¤ºã€PDFä¸‹è½½ç­‰å¤šä¸ªç¯èŠ‚ã€‚

### 1.2 ç”¨æˆ·ä½¿ç”¨æµç¨‹
1. ç”¨æˆ·åœ¨é¦–é¡µç‚¹å‡»"ç”Ÿæˆè¯•å·"å…¥å£
2. è¿›å…¥è¯•å·ç”Ÿæˆç•Œé¢ï¼ŒæŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯ï¼ˆå†å²è®°å½•æ•°ã€å¯ç”¨é¢˜ç›®æ•°ç­‰ï¼‰
3. é€‰æ‹©è¯•å·é¢˜ç›®æ•°é‡ï¼ˆ5/10/15/20é¢˜ï¼‰
4. å¯é€‰æ‹©é¢„è§ˆé¢˜ç›®åˆ—è¡¨
5. ç‚¹å‡»"ç”ŸæˆPDFè¯•å·"æŒ‰é’®
6. ç³»ç»Ÿç”ŸæˆPDFå¹¶å¼¹å‡ºåˆ†äº«/ä¿å­˜å¯¹è¯æ¡†

 ğŸ—ï¸ äºŒã€æŠ€æœ¯æ¶æ„

### 2.1 æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯ (React Native)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  GeneratePaperScreen.tsx (è¯•å·ç”Ÿæˆç•Œé¢)                 â”‚ â”‚
â”‚  â”‚  - ç»Ÿè®¡ä¿¡æ¯å±•ç¤º                                          â”‚ â”‚
â”‚  â”‚  - é¢˜ç›®æ•°é‡é€‰æ‹©å™¨                                        â”‚ â”‚
â”‚  â”‚  - é¢„è§ˆ/ç”ŸæˆæŒ‰é’®                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                     â”‚                                          â”‚
â”‚                     â†“                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  paperService.ts (è¯•å·æœåŠ¡å±‚)                           â”‚ â”‚
â”‚  â”‚  - getStatistics() - è·å–ç»Ÿè®¡ä¿¡æ¯                       â”‚ â”‚
â”‚  â”‚  - previewPaper() - é¢„è§ˆé¢˜ç›®                            â”‚ â”‚
â”‚  â”‚  - generateAndDownloadPaper() - ç”Ÿæˆå¹¶ä¸‹è½½PDF          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                     â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ HTTPè¯·æ±‚
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åç«¯ (Flask + Python)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  paper_endpoints.py (APIè·¯ç”±)                           â”‚ â”‚
â”‚  â”‚  - GET  /api/paper/statistics - è·å–ç»Ÿè®¡              â”‚ â”‚
â”‚  â”‚  - POST /api/paper/preview - é¢„è§ˆé¢˜ç›®                  â”‚ â”‚
â”‚  â”‚  - POST /api/paper/generate - ç”ŸæˆPDF                  â”‚ â”‚
â”‚  â”‚  - GET  /api/paper/health - å¥åº·æ£€æŸ¥                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                     â”‚                                          â”‚
â”‚                     â†“                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  paper_generator.py (PDFç”ŸæˆæœåŠ¡)                       â”‚ â”‚
â”‚  â”‚  - extract_similar_questions_from_history()            â”‚ â”‚
â”‚  â”‚  - generate_paper_pdf()                                 â”‚ â”‚
â”‚  â”‚  - ä¸­æ–‡å­—ä½“é…ç½® (å®‹ä½“/é»‘ä½“)                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ ¸å¿ƒæ–‡ä»¶ç»“æ„

#### å‰ç«¯æ–‡ä»¶
```
llmhomework_Frontend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ screens/
â”‚   â”‚   â””â”€â”€ GeneratePaperScreen.tsx      # è¯•å·ç”Ÿæˆä¸»ç•Œé¢
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ paperService.ts              # è¯•å·ç›¸å…³APIæœåŠ¡
â”‚   â””â”€â”€ navigation/
â”‚       â””â”€â”€ NavigationTypes.ts           # è·¯ç”±ç±»å‹å®šä¹‰
```

#### åç«¯æ–‡ä»¶
```
llmhomework_Backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ paper_endpoints.py           # APIè·¯ç”±ç«¯ç‚¹
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ paper_generator.py           # PDFç”Ÿæˆæ ¸å¿ƒé€»è¾‘
```

---

## ğŸ’» ä¸‰ã€å‰ç«¯å®ç°è¯¦è§£

### 3.1 GeneratePaperScreen.tsx - è¯•å·ç”Ÿæˆç•Œé¢

#### æ–‡ä»¶ä½ç½®
`llmhomework_Frontend/app/screens/GeneratePaperScreen.tsx` (å…±552è¡Œ)

#### ä¸»è¦åŠŸèƒ½æ¨¡å—

##### 3.1.1 çŠ¶æ€ç®¡ç†
```typescript
const [loading, setLoading] = useState(true);          // åŠ è½½çŠ¶æ€
const [generating, setGenerating] = useState(false);   // ç”Ÿæˆä¸­çŠ¶æ€
const [statistics, setStatistics] = useState<PaperStatistics | null>(null); // ç»Ÿè®¡ä¿¡æ¯
const [preview, setPreview] = useState<PaperPreview | null>(null);          // é¢„è§ˆæ•°æ®
const [selectedCount, setSelectedCount] = useState(10);                      // é€‰æ‹©çš„é¢˜ç›®æ•°é‡
```

##### 3.1.2 æ ¸å¿ƒæ–¹æ³•
- **loadStatistics()** - åŠ è½½ç»Ÿè®¡ä¿¡æ¯
  - è°ƒç”¨ `paperService.getStatistics()`
  - æ˜¾ç¤ºå†å²è®°å½•æ•°ã€å¯ç”¨é¢˜ç›®æ•°ã€æ¨èæ•°é‡

- **handlePreview()** - é¢„è§ˆè¯•å·
  - è°ƒç”¨ `paperService.previewPaper()`
  - å±•ç¤ºé¢˜ç›®åˆ—è¡¨ï¼ˆå‰3é¢˜ + è¿˜æœ‰Xé¢˜çš„æç¤ºï¼‰

- **handleGenerate()** - ç”Ÿæˆå¹¶ä¸‹è½½PDF
  - è°ƒç”¨ `paperService.generateAndDownloadPaper()`
  - æ˜¾ç¤ºç”Ÿæˆè¿›åº¦
  - è‡ªåŠ¨æ‰“å¼€åˆ†äº«å¯¹è¯æ¡†

##### 3.1.3 UIç»„ä»¶å¸ƒå±€
```
SafeAreaView
â”œâ”€â”€ Header (æ ‡é¢˜æ )
â”‚   â”œâ”€â”€ è¿”å›æŒ‰é’®
â”‚   â”œâ”€â”€ "ç”Ÿæˆè¯•å·"æ ‡é¢˜
â”‚   â””â”€â”€ å ä½å…ƒç´ ï¼ˆä¿æŒå±…ä¸­ï¼‰
â”œâ”€â”€ ScrollView
â”‚   â”œâ”€â”€ InfoCard (åŠŸèƒ½è¯´æ˜å¡ç‰‡)
â”‚   â”‚   â”œâ”€â”€ å›¾æ ‡ ğŸ“
â”‚   â”‚   â”œâ”€â”€ æ ‡é¢˜
â”‚   â”‚   â””â”€â”€ æè¿°æ–‡å­—
â”‚   â”œâ”€â”€ StatisticsCards (ç»Ÿè®¡ä¿¡æ¯å¡ç‰‡ç»„)
â”‚   â”‚   â”œâ”€â”€ å†å²è®°å½•æ•°
â”‚   â”‚   â”œâ”€â”€ å¯ç”¨é¢˜ç›®æ•°
â”‚   â”‚   â””â”€â”€ æ¨èæ•°é‡
â”‚   â”œâ”€â”€ QuestionCountSelector (é¢˜ç›®æ•°é‡é€‰æ‹©å™¨)
â”‚   â”‚   â””â”€â”€ [5é¢˜] [10é¢˜] [15é¢˜] [20é¢˜] æŒ‰é’®ç»„
â”‚   â”œâ”€â”€ WarningCard (é¢˜ç›®ä¸è¶³æ—¶æ˜¾ç¤º)
â”‚   â”œâ”€â”€ ActionButtons (æ“ä½œæŒ‰é’®)
â”‚   â”‚   â”œâ”€â”€ é¢„è§ˆé¢˜ç›®æŒ‰é’®
â”‚   â”‚   â””â”€â”€ ç”ŸæˆPDFè¯•å·æŒ‰é’®
â”‚   â””â”€â”€ PreviewContainer (é¢„è§ˆå†…å®¹ - å¯é€‰æ˜¾ç¤º)
â”‚       â”œâ”€â”€ é¢„è§ˆæ ‡é¢˜
â”‚       â”œâ”€â”€ é¢˜ç›®ç»Ÿè®¡
â”‚       â”œâ”€â”€ é¢˜ç›®1-3
â”‚       â””â”€â”€ "...è¿˜æœ‰Xé“é¢˜ç›®"
```

##### 3.1.4 æ ·å¼è®¾è®¡ç‰¹ç‚¹
- ä½¿ç”¨é¡¹ç›®ç»Ÿä¸€çš„è®¾è®¡ç³»ç»Ÿï¼ˆ`designSystem.ts`ï¼‰
- é¢œè‰²æ–¹æ¡ˆï¼š`primaryColor`ã€`successColor`ã€`errorColor` ç­‰
- å¡ç‰‡å¼å¸ƒå±€ï¼Œé˜´å½±æ•ˆæœï¼ˆ`shadows.level1/level2`ï¼‰
- æŒ‰é’®çŠ¶æ€ï¼šæ­£å¸¸/é€‰ä¸­/ç¦ç”¨ä¸‰æ€
- å“åº”å¼é—´è·ï¼ˆ`spacing.sm/md/lg`ï¼‰
- åœ†è§’è®¾è®¡ï¼ˆ`borderRadius.md/lg`ï¼‰

### 3.2 paperService.ts - è¯•å·æœåŠ¡å±‚

#### æ–‡ä»¶ä½ç½®
`llmhomework_Frontend/app/services/paperService.ts` (å…±265è¡Œ)

#### æ ¸å¿ƒAPIæ–¹æ³•

##### 3.2.1 getStatistics() - è·å–ç»Ÿè®¡ä¿¡æ¯
```typescript
async getStatistics(userId?: string): Promise<PaperStatistics>
```
- **è¯·æ±‚æ–¹å¼**: GET
- **APIç«¯ç‚¹**: `/api/paper/statistics`
- **è¿”å›æ•°æ®**:
  ```typescript
  {
    total_records: number;           // å†å²è®°å½•æ€»æ•°
    total_similar_questions: number; // å¯ç”¨é¢˜ç›®æ€»æ•°
    can_generate: boolean;           // æ˜¯å¦å¯ä»¥ç”Ÿæˆè¯•å·
    recommended_count: number;       // æ¨èç”Ÿæˆæ•°é‡
  }
  ```

##### 3.2.2 previewPaper() - é¢„è§ˆè¯•å·
```typescript
async previewPaper(options: GeneratePaperOptions): Promise<PaperPreview>
```
- **è¯·æ±‚æ–¹å¼**: POST
- **APIç«¯ç‚¹**: `/api/paper/preview`
- **è¯·æ±‚å‚æ•°**:
  ```typescript
  {
    user_id?: string;
    max_questions: number;  // è¦é¢„è§ˆçš„é¢˜ç›®æ•°é‡
  }
  ```
- **è¿”å›æ•°æ®**:
  ```typescript
  {
    questions: PaperQuestion[];  // é¢˜ç›®åˆ—è¡¨
    total_found: number;         // æ‰¾åˆ°çš„é¢˜ç›®æ€»æ•°
    will_use: number;            // å°†ä½¿ç”¨çš„é¢˜ç›®æ•°
    message: string;             // æç¤ºä¿¡æ¯
  }
  ```

##### 3.2.3 generateAndDownloadPaper() - ç”Ÿæˆå¹¶ä¸‹è½½PDF
```typescript
async generateAndDownloadPaper(options: GeneratePaperOptions): Promise<string>
```
- **è¯·æ±‚æ–¹å¼**: POST
- **APIç«¯ç‚¹**: `/api/paper/generate`
- **è¯·æ±‚å‚æ•°**:
  ```typescript
  {
    user_id?: string;
    max_questions: number;
    title: string;  // è¯•å·æ ‡é¢˜
  }
  ```
- **å¤„ç†æµç¨‹**:
  1. ä½¿ç”¨ `fetch` API å‘é€POSTè¯·æ±‚
  2. æ¥æ”¶PDFçš„Blobæ•°æ®
  3. è½¬æ¢ä¸ºBase64ç¼–ç 
  4. ä½¿ç”¨ `expo-file-system` å†™å…¥æœ¬åœ°æ–‡ä»¶
  5. ä½¿ç”¨ `expo-sharing` æ‰“å¼€åˆ†äº«å¯¹è¯æ¡†
- **è¿”å›**: æœ¬åœ°æ–‡ä»¶URI

##### 3.2.4 æŠ€æœ¯ç»†èŠ‚
- **ç½‘ç»œè¯·æ±‚**: ä½¿ç”¨ `axios` å’Œ `fetch` æ··åˆï¼ˆPDFä¸‹è½½ç”¨fetchï¼‰
- **è¶…æ—¶è®¾ç½®**: 
  - ç»Ÿè®¡ä¿¡æ¯: 10ç§’
  - é¢„è§ˆ: 15ç§’
  - ç”ŸæˆPDF: æ— è¶…æ—¶ï¼ˆå¤§æ–‡ä»¶ï¼‰
- **é”™è¯¯å¤„ç†**: ä¸‰å±‚é”™è¯¯å¤„ç†æœºåˆ¶
  1. æœåŠ¡å™¨è¿”å›é”™è¯¯ (`response.data.error`)
  2. ç½‘ç»œé”™è¯¯ (`request` æ— å“åº”)
  3. å…¶ä»–æœªçŸ¥é”™è¯¯

---

## ğŸ”§ å››ã€åç«¯å®ç°è¯¦è§£

### 4.1 paper_generator.py - PDFç”Ÿæˆæ ¸å¿ƒ

#### æ–‡ä»¶ä½ç½®
`llmhomework_Backend/app/services/paper_generator.py` (å…±413è¡Œ)

#### æ ¸å¿ƒåŠŸèƒ½

##### 4.1.1 ä¸­æ–‡å­—ä½“é…ç½®
```python
# å­—ä½“é…ç½®
FONT_NAME = 'SimSun'      # å®‹ä½“ - ç”¨äºæ­£æ–‡
FONT_BOLD_NAME = 'SimHei' # é»‘ä½“ - ç”¨äºæ ‡é¢˜

# å­—ä½“æœç´¢è·¯å¾„ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰
font_paths = [
    'C:/Windows/Fonts/simsun.ttc',              # Windows
    '/usr/share/fonts/truetype/simsun.ttc',     # Linux
    'llmhomework_Backend/fonts/simsun.ttc',     # é¡¹ç›®æœ¬åœ°
]
```

**å­—ä½“æ³¨å†Œæµç¨‹**:
1. éå†å­—ä½“è·¯å¾„æŸ¥æ‰¾å­—ä½“æ–‡ä»¶
2. ä½¿ç”¨ `pdfmetrics.registerFont()` æ³¨å†Œ
3. å¦‚æœå¤±è´¥ï¼Œè®°å½•è­¦å‘Šä½†ä¸ä¸­æ–­ç¨‹åº
4. æœ€ç»ˆå›é€€åˆ°ç³»ç»Ÿé»˜è®¤å­—ä½“

##### 4.1.2 extract_similar_questions_from_history() - é¢˜ç›®æå–
ä»å†å²è®°å½•ä¸­æå–é¢˜ç›®ï¼Œæ”¯æŒå¤šç§æ•°æ®æ ¼å¼ï¼š

**æ–¹æ³•1**: æ–°æ ¼å¼ - `similar_questions` å­—æ®µ
```json
{
  "similar_questions": [
    {"question": "é¢˜ç›®å†…å®¹", "type": "é€‰æ‹©é¢˜"}
  ]
}
```

**æ–¹æ³•2**: åµŒå¥—æ ¼å¼ - `grading_result.similar_question`
```json
{
  "grading_result": {
    "grading_result": [
      {"similar_question": "é¢˜ç›®å†…å®¹", "type": "è®¡ç®—é¢˜"}
    ]
  }
}
```

**æ–¹æ³•3**: å…¼å®¹æ—§æ ¼å¼ - ç›´æ¥ä½¿ç”¨åŸé¢˜ç›®
```json
{
  "grading_result": [
    {"question": "é¢˜ç›®å†…å®¹", "type": "å¡«ç©ºé¢˜"}
  ]
}
```

**å»é‡é€»è¾‘**: åŸºäºé¢˜ç›®å†…å®¹å­—ç¬¦ä¸²çš„ `set` å»é‡

##### 4.1.3 generate_paper_pdf() - PDFç”Ÿæˆ
ä½¿ç”¨ ReportLab åº“ç”Ÿæˆä¸“ä¸šPDFï¼š

**PDFå¸ƒå±€ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç»ƒä¹ è¯•å·ï¼ˆæ ‡é¢˜ï¼Œ18å·é»‘ä½“ï¼‰      â”‚
â”‚                                     â”‚
â”‚ ç”Ÿæˆæ—¶é—´ï¼š2024å¹´XXæœˆXXæ—¥ XX:XX      â”‚
â”‚ å§“åï¼š__________  åˆ†æ•°ï¼š__________   â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                     â”‚
â”‚ 1. [é¢˜å‹]                           â”‚
â”‚    é¢˜ç›®å†…å®¹...ï¼ˆ10å·å®‹ä½“ï¼‰           â”‚
â”‚    é¢˜ç›®å†…å®¹ç¬¬äºŒè¡Œ...                 â”‚
â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚
â”‚    ç­”ï¼š_________________________     â”‚
â”‚                                     â”‚
â”‚ 2. [é¢˜å‹]                           â”‚
â”‚    é¢˜ç›®å†…å®¹...                       â”‚
â”‚    ...                              â”‚
â”‚                                     â”‚
â”‚             ç¬¬ 1 é¡µ                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æŠ€æœ¯å‚æ•°**:
- é¡µé¢å¤§å°: A4 (210mm Ã— 297mm)
- é¡µè¾¹è·: 2cm
- æ ‡é¢˜å­—å·: 18å·ï¼ˆé»‘ä½“ï¼‰
- é¢˜å·å­—å·: 11å·ï¼ˆé»‘ä½“ï¼‰
- é¢˜ç›®å­—å·: 10å·ï¼ˆå®‹ä½“ï¼‰
- ç­”æ¡ˆè¡Œå­—å·: 9å·ï¼ˆå®‹ä½“ï¼‰
- è¡Œé—´è·: 0.6cm

**è‡ªåŠ¨æ¢é¡µé€»è¾‘**:
- å½“å‰©ä½™é«˜åº¦ < 5cm æ—¶ï¼Œé¢˜ç›®æ¢é¡µ
- å½“å‰©ä½™é«˜åº¦ < 3cm æ—¶ï¼Œé¢˜ç›®å†…å®¹è¡Œæ¢é¡µ

##### 4.1.4 æ–‡æœ¬æ¢è¡Œå¤„ç†
```python
def _wrap_text(self, text: str, max_width_mm: float) -> List[str]:
    # å‡è®¾ä¸­æ–‡å­—ç¬¦å®½åº¦çº¦ä¸º 4mmï¼Œè‹±æ–‡çº¦ä¸º 2mm
    max_chars = int(max_width_mm / 4)  # ä¿å®ˆä¼°è®¡
    # æŒ‰å­—ç¬¦æ•°æ‹†åˆ†æ–‡æœ¬...
```
 4.2 paper_endpoints.py - APIç«¯ç‚¹

#### æ–‡ä»¶ä½ç½®
`llmhomework_Backend/app/api/paper_endpoints.py` (å…±324è¡Œ)

#### APIç«¯ç‚¹è¯¦è§£

##### 4.2.1 POST /api/paper/generate - ç”Ÿæˆè¯•å·
- **åŠŸèƒ½**: ç”ŸæˆPDFå¹¶è¿”å›æ–‡ä»¶æµ
- **å‚æ•°éªŒè¯**: é¢˜ç›®æ•°é‡å¿…é¡»åœ¨1-50ä¹‹é—´
- **å¤„ç†æµç¨‹**:
  1. è·å–å†å²è®°å½• (`get_records`)
  2. è°ƒç”¨ `generate_paper_from_history` ç”ŸæˆPDF
  3. ä½¿ç”¨ `send_file` è¿”å›PDFæµ
- **æ–‡ä»¶åæ ¼å¼**: `exam_paper_YYYYMMDD_HHMMSS.pdf`

##### 4.2.2 POST /api/paper/preview - é¢„è§ˆé¢˜ç›®
- **åŠŸèƒ½**: è¿”å›é¢˜ç›®åˆ—è¡¨ï¼Œä¸ç”ŸæˆPDF
- **è¿”å›**: é¢˜ç›®æ•°ç»„ + ç»Ÿè®¡ä¿¡æ¯
- **ç”¨é€”**: è®©ç”¨æˆ·åœ¨ç”Ÿæˆå‰æŸ¥çœ‹å°†è¦åŒ…å«çš„é¢˜ç›®

##### 4.2.3 GET /api/paper/statistics - ç»Ÿè®¡ä¿¡æ¯
- **åŠŸèƒ½**: è¿”å›å†å²è®°å½•å’Œå¯ç”¨é¢˜ç›®çš„ç»Ÿè®¡
- **è®¡ç®—é€»è¾‘**:
  - `total_records`: å†å²è®°å½•æ€»æ•°
  - `total_similar_questions`: æå–å‡ºçš„é¢˜ç›®æ€»æ•°ï¼ˆæœ€å¤š100ï¼‰
  - `can_generate`: æ˜¯å¦æœ‰é¢˜ç›®å¯ç”Ÿæˆ
  - `recommended_count`: å»ºè®®ç”Ÿæˆæ•°é‡ï¼ˆmin(total, 10)ï¼‰

##### 4.2.4 GET /api/paper/health - å¥åº·æ£€æŸ¥
- **åŠŸèƒ½**: æ£€æŸ¥æœåŠ¡çŠ¶æ€å’Œå­—ä½“æ”¯æŒ
- **è¿”å›ç¤ºä¾‹**:
  ```json
  {
    "status": "healthy",
    "service": "paper_generator",
    "font_support": "ok"  // æˆ– "warning - using default font"
  }
  ```

#### é”™è¯¯å¤„ç†æœºåˆ¶
```python
try:
    # ä¸šåŠ¡é€»è¾‘
except ValueError as e:
    # ä¸šåŠ¡é”™è¯¯ï¼ˆé¢˜ç›®ä¸è¶³ç­‰ï¼‰- 400
    return jsonify({'error': str(e)}), 400
except Exception as e:
    # ç³»ç»Ÿé”™è¯¯ - 500
    return jsonify({'error': 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'}), 500
```

---

## ğŸ“¦ äº”ã€ä¾èµ–å’Œé…ç½®

### 5.1 å‰ç«¯ä¾èµ–
```json
{
  "expo-file-system": "^17.0.0",  // æ–‡ä»¶ç³»ç»Ÿè®¿é—®
  "expo-sharing": "^12.0.0",      // æ–‡ä»¶åˆ†äº«åŠŸèƒ½
  "axios": "^1.6.0",              // HTTPå®¢æˆ·ç«¯
  "react-native": "^0.73.0"       // RNæ¡†æ¶
}
```

### 5.2 åç«¯ä¾èµ–
```python
Flask==3.0.0          # Webæ¡†æ¶
reportlab==4.0.0      # PDFç”Ÿæˆåº“
```

### 5.3 ä¸­æ–‡å­—ä½“å®‰è£…

#### Windowsç³»ç»Ÿ
ç³»ç»Ÿè‡ªå¸¦å®‹ä½“ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

#### Linuxç³»ç»Ÿ
```bash
# æ–¹æ³•1: å®‰è£…æ–‡æ³‰é©¿å­—ä½“
sudo apt-get install fonts-wqy-zenhei

# æ–¹æ³•2: å®‰è£…MSæ ¸å¿ƒå­—ä½“
sudo apt-get install ttf-mscorefonts-installer

# æ–¹æ³•3: æ‰‹åŠ¨å®‰è£…
# 1. ä¸‹è½½ simsun.ttc
# 2. æ”¾åˆ° /usr/share/fonts/truetype/
# 3. æ›´æ–°å­—ä½“ç¼“å­˜
sudo fc-cache -fv
```

---

ğŸ¯ å…­ã€ä½ çš„å¼€å‘ä»»åŠ¡

### ä»»åŠ¡1: è°ƒæ•´è¯•å·çš„æ’ç‰ˆé—®é¢˜

#### é—®é¢˜æè¿°
å½“å‰ç”Ÿæˆçš„PDFè¯•å·åœ¨æ’ç‰ˆä¸Šå¯èƒ½å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š
1. é¢˜ç›®å†…å®¹è¿‡é•¿æ—¶æ¢è¡Œä¸å¤Ÿç¾è§‚
2. é¢˜ç›®ä¹‹é—´çš„é—´è·å¯èƒ½ä¸å¤Ÿå‡åŒ€
3. é¡µé¢åˆ©ç”¨ç‡å¯èƒ½ä¸å¤Ÿåˆç†
4. ç­”é¢˜ç©ºé—´å¯èƒ½ä¸å¤Ÿå……è¶³

#### å…·ä½“è¦æ±‚
1. **ä¼˜åŒ–é¢˜ç›®æ¢è¡Œé€»è¾‘**
   - æ–‡ä»¶ä½ç½®: `llmhomework_Backend/app/services/paper_generator.py`
   - ç›®æ ‡æ–¹æ³•: `_wrap_text()` (ç¬¬338-366è¡Œ)
   - æ”¹è¿›ç‚¹:
     - å½“å‰æŒ‰å­—ç¬¦æ•°ç²—ç•¥æ‹†åˆ†ï¼Œéœ€è¦æ”¹è¿›ä¸ºæŒ‰å®é™…å­—ç¬¦å®½åº¦è®¡ç®—
     - æ”¯æŒè‹±æ–‡å•è¯ä¸æ–­è¡Œï¼ˆé‡åˆ°ç©ºæ ¼æ‰æ¢è¡Œï¼‰
     - æ”¯æŒæ•°å­¦å…¬å¼ã€ç‰¹æ®Šç¬¦å·çš„æ™ºèƒ½æ¢è¡Œ

2. **è°ƒæ•´é¢˜ç›®é—´è·å’Œå¸ƒå±€**
   - æ–‡ä»¶ä½ç½®: `paper_generator.py`
   - ç›®æ ‡æ–¹æ³•: `generate_paper_pdf()` (ç¬¬182-328è¡Œ)
   - æ”¹è¿›ç‚¹:
     - è°ƒæ•´é¢˜ç›®ä¹‹é—´çš„å‚ç›´é—´è·ï¼ˆå½“å‰æ˜¯0.5cmï¼Œå¯èƒ½éœ€è¦ä¼˜åŒ–ï¼‰
     - è°ƒæ•´ç­”é¢˜åŒºåŸŸçš„é«˜åº¦ï¼ˆå½“å‰æ˜¯1.5cmå›ºå®šå€¼ï¼‰
     - æ ¹æ®é¢˜ç›®ç±»å‹åŠ¨æ€è°ƒæ•´ç­”é¢˜ç©ºé—´ï¼ˆé€‰æ‹©é¢˜è¾ƒå°ï¼Œè®¡ç®—é¢˜è¾ƒå¤§ï¼‰

3. **ä¼˜åŒ–é¡µé¢å¸ƒå±€**
   - æ”¹è¿›ç‚¹:
     - è°ƒæ•´é¡µè¾¹è·ï¼ˆå½“å‰æ˜¯2cmï¼Œè€ƒè™‘æ‰“å°æœºè¾¹è·ï¼‰
     - ä¼˜åŒ–æ ‡é¢˜åŒºåŸŸé«˜åº¦
     - æ”¹å–„é¡µè„šä½ç½®

4. **æ”¹è¿›è‡ªåŠ¨æ¢é¡µé€»è¾‘**
   - å½“å‰æ¢é¡µé˜ˆå€¼:
     - é¢˜ç›®æ¢é¡µ: å‰©ä½™é«˜åº¦ < 5cm
     - å†…å®¹è¡Œæ¢é¡µ: å‰©ä½™é«˜åº¦ < 3cm
   - æ”¹è¿›ç›®æ ‡:
     - é¿å…ä¸€é“é¢˜çš„æ ‡é¢˜å’Œå†…å®¹åˆ†å¼€åœ¨ä¸¤é¡µ
     - ç¡®ä¿æ¯é“é¢˜å®Œæ•´æ€§
     - ä¼˜åŒ–æœ€åä¸€é¡µçš„å†…å®¹åˆ†å¸ƒ

#### å‚è€ƒä»£ç ä½ç½®
```python
# paper_generator.py ä¸­çš„å…³é”®å˜é‡
self.page_width, self.page_height = A4  # é¡µé¢å¤§å°
self.margin = 2 * cm                     # é¡µè¾¹è·
self.content_width = self.page_width - 2 * self.margin  # å†…å®¹å®½åº¦

# é¢˜ç›®å¸ƒå±€ç›¸å…³çš„Yåæ ‡è°ƒæ•´
y -= 0.7 * cm  # é¢˜å·åçš„é—´è·
y -= 0.6 * cm  # æ¯è¡Œé¢˜ç›®å†…å®¹çš„é—´è·
y -= 1.5 * cm  # ç­”é¢˜åŒºåŸŸçš„é«˜åº¦
y -= 0.5 * cm  # é¢˜ç›®ä¹‹é—´çš„é—´è·
```

#### éªŒè¯æ–¹æ³•
1. ç”ŸæˆåŒ…å«5é¢˜ã€10é¢˜ã€20é¢˜çš„ä¸åŒè¯•å·
2. æ£€æŸ¥å„ç§é•¿åº¦çš„é¢˜ç›®çš„æ¢è¡Œæ•ˆæœ
3. æ£€æŸ¥å¤šé¡µè¯•å·çš„æ¢é¡µä½ç½®
4. æ‰“å°å®é™…PDFæŸ¥çœ‹æ•ˆæœ

---

### ä»»åŠ¡2: è°ƒæ•´å­—ä½“é—®é¢˜ï¼Œè®©æ‰€æœ‰ç‰¹æ®Šç¬¦å·å¯ä»¥æ­£å¸¸æ˜¾ç¤º

#### é—®é¢˜æè¿°
å½“å‰PDFå¯èƒ½æ— æ³•æ­£ç¡®æ˜¾ç¤ºä»¥ä¸‹å†…å®¹ï¼š
1. æ•°å­¦ç¬¦å·ï¼šâˆšã€â‰ˆã€â‰ ã€â‰¤ã€â‰¥ã€âˆã€âˆ‘ã€âˆ«ã€Ï€ ç­‰
2. å¸Œè…Šå­—æ¯ï¼šÎ±ã€Î²ã€Î³ã€Î¸ã€Î»ã€Î¼ã€Ïƒã€Î© ç­‰
3. ä¸Šä¸‹æ ‡ï¼šxÂ²ã€xâ‚ã€COâ‚‚ ç­‰
4. ç‰¹æ®Šå­—ç¬¦ï¼šâ„ƒã€Â°ã€â„¢ã€Â©ã€Â® ç­‰
5. åˆ†æ•°ã€æ ¹å¼ç­‰å¤æ‚æ•°å­¦è¡¨è¾¾å¼

#### å…·ä½“è¦æ±‚

##### 2.1 å­—ä½“é…ç½®ä¼˜åŒ–
æ–‡ä»¶ä½ç½®: `paper_generator.py` ç¬¬26-84è¡Œ

**å½“å‰å­—ä½“é…ç½®**:
```python
FONT_NAME = 'SimSun'      # å®‹ä½“
FONT_BOLD_NAME = 'SimHei' # é»‘ä½“
```

**æ”¹è¿›æ–¹æ¡ˆ**:
1. **æ·»åŠ ç¬¦å·å­—ä½“æ”¯æŒ**
   - æ³¨å†Œæ”¯æŒæ•°å­¦ç¬¦å·çš„å­—ä½“ï¼ˆå¦‚ Arial Unicode MSã€å®‹ä½“æ‰©å±•ç‰ˆï¼‰
   - é…ç½®å­—ä½“å›é€€æœºåˆ¶ï¼ˆFont Fallbackï¼‰

2. **å­—ä½“è·¯å¾„æ‰©å±•**
   - æ·»åŠ æ›´å¤šç³»ç»Ÿå­—ä½“è·¯å¾„
   - æ”¯æŒè‡ªå®šä¹‰å­—ä½“ç›®å½•
   - æ·»åŠ å­—ä½“æ£€æµ‹å’ŒéªŒè¯é€»è¾‘

3. **å­—ä½“æµ‹è¯•**
   - ç¼–å†™å­—ä½“åŠŸèƒ½æµ‹è¯•ä»£ç 
   - æµ‹è¯•å¸¸è§ç‰¹æ®Šç¬¦å·æ˜¯å¦èƒ½æ­£å¸¸æ˜¾ç¤º
   - ç”Ÿæˆå­—ä½“æ”¯æŒæŠ¥å‘Š

##### 2.2 ç‰¹æ®Šç¬¦å·å¤„ç†
**æ–¹æ¡ˆA: Unicodeè§„èŒƒåŒ–**
```python
import unicodedata

def normalize_text(text: str) -> str:
    """å°†æ–‡æœ¬è§„èŒƒåŒ–ä¸ºNFCæ ¼å¼ï¼Œç¡®ä¿Unicodeå­—ç¬¦æ­£ç¡®"""
    return unicodedata.normalize('NFC', text)
```

**æ–¹æ¡ˆB: å­—ç¬¦æ›¿æ¢**
å¯¹äºä¸æ”¯æŒçš„ç¬¦å·ï¼Œæä¾›æ›¿ä»£æ–¹æ¡ˆï¼š
```python
SYMBOL_REPLACEMENTS = {
    'âˆš': '[æ ¹å·]',
    'âˆ«': '[ç§¯åˆ†]',
    # ... æ›´å¤šæ˜ å°„
}
```

**æ–¹æ¡ˆC: æ•°å­¦å…¬å¼å›¾ç‰‡åŒ–**ï¼ˆé«˜çº§æ–¹æ¡ˆï¼‰
- ä½¿ç”¨ matplotlib æˆ– PIL å°†å¤æ‚æ•°å­¦å…¬å¼æ¸²æŸ“ä¸ºå›¾ç‰‡
- å°†å›¾ç‰‡åµŒå…¥PDFä¸­
- é€‚ç”¨äºå¤æ‚æ•°å­¦è¡¨è¾¾å¼

##### 2.3 æµ‹è¯•å’ŒéªŒè¯

**åˆ›å»ºæµ‹è¯•é¢˜ç›®é›†**:
åœ¨åç«¯åˆ›å»ºæµ‹è¯•è„šæœ¬ `test_paper_symbols.py`:
```python
"""
æµ‹è¯•å„ç§ç‰¹æ®Šç¬¦å·åœ¨PDFä¸­çš„æ˜¾ç¤ºæ•ˆæœ
"""
test_questions = [
    {
        "question": "è®¡ç®—ï¼šâˆš2 + âˆš3 â‰ˆ ?",
        "type": "è®¡ç®—é¢˜"
    },
    {
        "question": "å·²çŸ¥è§’åº¦Î¸ = 30Â°ï¼Œæ±‚sinÎ¸çš„å€¼",
        "type": "è®¡ç®—é¢˜"
    },
    {
        "question": "COâ‚‚çš„åˆ†å­å¼ä¸­å«æœ‰å‡ ä¸ªæ°§åŸå­ï¼Ÿ",
        "type": "é€‰æ‹©é¢˜"
    },
    {
        "question": "è¯æ˜ï¼šxÂ² + yÂ² â‰¥ 2xy",
        "type": "è¯æ˜é¢˜"
    },
    {
        "question": "è®¡ç®—ç§¯åˆ†ï¼šâˆ«â‚€Â¹ xÂ²dx",
        "type": "è®¡ç®—é¢˜"
    }
]

# ç”Ÿæˆæµ‹è¯•PDF
generator = PaperGenerator()
pdf = generator.generate_paper_pdf(test_questions, title="ç‰¹æ®Šç¬¦å·æµ‹è¯•è¯•å·")
```

**éªŒè¯æ¸…å•**:
- [ ] åŸºæœ¬æ•°å­¦è¿ç®—ç¬¦ï¼ˆ+ã€-ã€Ã—ã€Ã·ï¼‰
- [ ] æ¯”è¾ƒç¬¦å·ï¼ˆ=ã€â‰ ã€<ã€>ã€â‰¤ã€â‰¥ã€â‰ˆï¼‰
- [ ] æ ¹å·å’ŒæŒ‡æ•°ï¼ˆâˆšã€Â²ã€Â³ï¼‰
- [ ] å¸Œè…Šå­—æ¯ï¼ˆÎ±ã€Î²ã€Î³ã€Ï€ã€Î¸ã€Î£ï¼‰
- [ ] åŒ–å­¦ç¬¦å·ï¼ˆCOâ‚‚ã€Hâ‚‚Oã€ä¸Šä¸‹æ ‡ï¼‰
- [ ] è§’åº¦å’Œæ¸©åº¦ï¼ˆÂ°ã€â„ƒï¼‰
- [ ] ç§¯åˆ†å’Œæ±‚å’Œï¼ˆâˆ«ã€âˆ‘ï¼‰
- [ ] ç‰¹æ®Šæ ‡ç‚¹ï¼ˆâ€¦ã€â€”ã€Â·ï¼‰

##### 2.4 å‰ç«¯é…åˆå·¥ä½œï¼ˆå¯é€‰ï¼‰
å¦‚æœå‘ç°é¢˜ç›®æ–‡æœ¬ä¸­çš„ç¬¦å·åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«ç ´åï¼š

1. **æ£€æŸ¥ç¼–ç é—®é¢˜**
   - æ–‡ä»¶ä½ç½®: `paperService.ts`
   - ç¡®ä¿ `Content-Type` è®¾ç½®ä¸º `application/json; charset=utf-8`

2. **æ–‡æœ¬é¢„å¤„ç†**
   - åœ¨å‘é€åˆ°åç«¯å‰å¯¹ç‰¹æ®Šç¬¦å·è¿›è¡Œè½¬ä¹‰æˆ–ç¼–ç 

#### å‚è€ƒèµ„æº
1. **ReportLabå­—ä½“æ–‡æ¡£**: https://docs.reportlab.com/reportlab/userguide/ch3_fonts/
2. **Unicodeå­—ç¬¦è¡¨**: https://unicode-table.com/
3. **Pythonå­—ä½“å¤„ç†**: `fontTools` åº“

---

## ğŸ“‹ ä¸ƒã€å¼€å‘æµç¨‹å»ºè®®

### 7.1 ç¯å¢ƒå‡†å¤‡
1. **å®‰è£…å¼€å‘ç¯å¢ƒ**
   ```bash
   # åç«¯
   cd llmhomework_Backend
   pip install -r requirements.txt
   
   # å‰ç«¯
   cd llmhomework_Frontend
   npm install
   ```

2. **å¯åŠ¨é¡¹ç›®**
   ```bash
   # å¯åŠ¨åç«¯
   cd llmhomework_Backend
   python run.py
   
   # å¯åŠ¨å‰ç«¯
   cd llmhomework_Frontend
   npm start
   ```

3. **æµ‹è¯•è¯•å·ç”ŸæˆåŠŸèƒ½**
   - åœ¨æ‰‹æœºæˆ–æ¨¡æ‹Ÿå™¨ä¸Šæ‰“å¼€åº”ç”¨
   - å…ˆå®Œæˆä¸€äº›ä½œä¸šæ‰¹æ”¹ï¼Œç§¯ç´¯å†å²è®°å½•
   - è¿›å…¥"ç”Ÿæˆè¯•å·"ç•Œé¢æµ‹è¯•åŠŸèƒ½

### 7.2 å¼€å‘æ­¥éª¤

#### ä»»åŠ¡1çš„å¼€å‘æ­¥éª¤
1. **äº†è§£ç°æœ‰ä»£ç ** (1-2å°æ—¶)
   - é˜…è¯» `paper_generator.py` çš„ `generate_paper_pdf` æ–¹æ³•
   - è¿è¡Œä»£ç ç”Ÿæˆå‡ ä»½æµ‹è¯•PDFï¼Œè§‚å¯Ÿé—®é¢˜

2. **åˆ†æå’Œè®¾è®¡** (2-3å°æ—¶)
   - æµ‹é‡æ‰“å°å‡ºçš„PDFï¼Œè®°å½•å®é™…å°ºå¯¸
   - åˆ—å‡ºéœ€è¦è°ƒæ•´çš„å‚æ•°æ¸…å•
   - è®¾è®¡æ›´åˆç†çš„å¸ƒå±€æ–¹æ¡ˆ

3. **å®ç°æ”¹è¿›** (4-6å°æ—¶)
   - ä¿®æ”¹ `_wrap_text` æ–¹æ³•ï¼Œæ”¹è¿›æ¢è¡Œé€»è¾‘
   - è°ƒæ•´ `generate_paper_pdf` ä¸­çš„é—´è·å‚æ•°
   - ä¼˜åŒ–æ¢é¡µåˆ¤æ–­æ¡ä»¶

4. **æµ‹è¯•éªŒè¯** (2-3å°æ—¶)
   - ç”Ÿæˆå„ç§é¢˜ç›®æ•°é‡çš„è¯•å·
   - æµ‹è¯•é•¿é¢˜ç›®ã€çŸ­é¢˜ç›®çš„æ˜¾ç¤ºæ•ˆæœ
   - æ‰“å°å®é™…PDFæŸ¥çœ‹æ•ˆæœ

5. **ä»£ç å®¡æŸ¥å’Œä¼˜åŒ–** (1-2å°æ—¶)
   - ä»£ç æ³¨é‡Šå®Œå–„
   - å‚æ•°å¯é…ç½®åŒ–ï¼ˆä¸è¦ç¡¬ç¼–ç ï¼‰
   - æäº¤ä»£ç 

#### ä»»åŠ¡2çš„å¼€å‘æ­¥éª¤
1. **è°ƒç ”å’Œæµ‹è¯•** (2-3å°æ—¶)
   - ç ”ç©¶ ReportLab çš„å­—ä½“æœºåˆ¶
   - åˆ›å»ºç¬¦å·æµ‹è¯•é›†
   - ç”Ÿæˆæµ‹è¯•PDFï¼Œè®°å½•å“ªäº›ç¬¦å·æ— æ³•æ˜¾ç¤º

2. **å­—ä½“é…ç½®** (3-4å°æ—¶)
   - æŸ¥æ‰¾å’Œå®‰è£…æ”¯æŒç‰¹æ®Šç¬¦å·çš„ä¸­æ–‡å­—ä½“
   - ä¿®æ”¹å­—ä½“æ³¨å†Œé€»è¾‘
   - å®ç°å­—ä½“å›é€€æœºåˆ¶

3. **ç¬¦å·å¤„ç†** (3-4å°æ—¶)
   - å®ç°Unicodeè§„èŒƒåŒ–
   - å¯¹ä¸æ”¯æŒçš„ç¬¦å·æä¾›æ›¿ä»£æ–¹æ¡ˆ
   - æµ‹è¯•å„ç§ç¬¦å·çš„æ˜¾ç¤ºæ•ˆæœ

4. **ç»¼åˆæµ‹è¯•** (2-3å°æ—¶)
   - ä½¿ç”¨åŒ…å«å„ç§ç¬¦å·çš„é¢˜ç›®ç”Ÿæˆè¯•å·
   - åœ¨ä¸åŒç³»ç»Ÿï¼ˆWindowsã€Linuxï¼‰ä¸Šæµ‹è¯•
   - è®°å½•æµ‹è¯•ç»“æœ

5. **æ–‡æ¡£ç¼–å†™** (1-2å°æ—¶)
   - ç¼–å†™å­—ä½“å®‰è£…æŒ‡å—
   - è®°å½•å·²æ”¯æŒå’Œä¸æ”¯æŒçš„ç¬¦å·
   - æä¾›ä½¿ç”¨å»ºè®®

### 7.3 æ—¶é—´è§„åˆ’å»ºè®®
- **ä»»åŠ¡1**: é¢„è®¡ 10-16 å°æ—¶
- **ä»»åŠ¡2**: é¢„è®¡ 11-16 å°æ—¶
- **æ€»è®¡**: 3-4 å¤©ï¼ˆæ¯å¤©å·¥ä½œ6-8å°æ—¶ï¼‰

### 7.4 æäº¤è§„èŒƒ
```bash
# Gitæäº¤ä¿¡æ¯æ ¼å¼
git commit -m "feat(paper): ä¼˜åŒ–è¯•å·æ’ç‰ˆï¼Œæ”¹è¿›é¢˜ç›®æ¢è¡Œé€»è¾‘"
git commit -m "fix(paper): ä¿®å¤ç‰¹æ®Šç¬¦å·æ˜¾ç¤ºé—®é¢˜ï¼Œæ·»åŠ å­—ä½“å›é€€"
git commit -m "test(paper): æ·»åŠ ç‰¹æ®Šç¬¦å·æ˜¾ç¤ºæµ‹è¯•"
```

---

## ğŸ” å…«ã€è°ƒè¯•å’Œæµ‹è¯•æŠ€å·§

### 8.1 åç«¯è°ƒè¯•

#### æ—¥å¿—æŸ¥çœ‹
åç«¯ä½¿ç”¨ Python `logging` æ¨¡å—ï¼Œå…³é”®æ—¥å¿—ï¼š
```python
logger.info("ğŸ“ ä»å†å²è®°å½•ä¸­æå–äº† X é“é¢˜ç›®")
logger.info("âœ… PDFè¯•å·ç”ŸæˆæˆåŠŸ")
logger.error("âŒ ç”ŸæˆPDFå¤±è´¥: error")
```

æŸ¥çœ‹æ—¥å¿—ä½ç½®ï¼šæ§åˆ¶å°è¾“å‡º

#### ç”Ÿæˆæµ‹è¯•PDF
åˆ›å»ºæµ‹è¯•è„šæœ¬ `test_paper_local.py`:
```python
from app.services.paper_generator import PaperGenerator

generator = PaperGenerator()

# æµ‹è¯•é¢˜ç›®
questions = [
    {"question": "è¿™æ˜¯ä¸€é“éå¸¸éå¸¸éå¸¸éå¸¸éå¸¸éå¸¸éå¸¸éå¸¸éå¸¸éå¸¸éå¸¸éå¸¸éå¸¸é•¿çš„é¢˜ç›®ï¼Œç”¨äºæµ‹è¯•æ¢è¡Œæ•ˆæœ", "type": "å¡«ç©ºé¢˜"},
    {"question": "è®¡ç®—ï¼šâˆš2 + Ï€ â‰ˆ ?", "type": "è®¡ç®—é¢˜"},
    # ... æ›´å¤šæµ‹è¯•é¢˜
]

# ç”ŸæˆPDF
pdf = generator.generate_paper_pdf(questions, title="æµ‹è¯•è¯•å·", output_path="test_output.pdf")
print("PDFå·²ç”Ÿæˆ: test_output.pdf")
```

è¿è¡Œï¼š
```bash
cd llmhomework_Backend
python test_paper_local.py
```

### 8.2 å‰ç«¯è°ƒè¯•

#### React Native è°ƒè¯•
1. **å¼€å¯è°ƒè¯•èœå•**
   - iOSæ¨¡æ‹Ÿå™¨: `Cmd + D`
   - Androidæ¨¡æ‹Ÿå™¨: `Cmd + M` (Mac) æˆ– `Ctrl + M` (Windows)

2. **æŸ¥çœ‹ç½‘ç»œè¯·æ±‚**
   - é€‰æ‹© "Debug" é€‰é¡¹
   - æ‰“å¼€ Chrome DevTools
   - æŸ¥çœ‹ Network æ ‡ç­¾é¡µ

#### æ—¥å¿—æŸ¥çœ‹
å‰ç«¯ä½¿ç”¨ `console.log`:
```typescript
console.log('ğŸ“Š è·å–ç»Ÿè®¡ä¿¡æ¯æˆåŠŸ:', statistics);
console.log('âœ… PDFä¸‹è½½æˆåŠŸ:', fileUri);
console.error('âŒ ç”Ÿæˆå¤±è´¥:', error);
```

æŸ¥çœ‹æ—¥å¿—ï¼š
- Expoå¼€å‘å·¥å…·ç•Œé¢
- ç»ˆç«¯è¾“å‡º
- Chrome DevTools Console

#### æµ‹è¯•PDFä¸‹è½½
```typescript
// åœ¨ GeneratePaperScreen.tsx ä¸­æ·»åŠ æµ‹è¯•æŒ‰é’®
const testDownload = async () => {
  try {
    const result = await paperService.generateAndDownloadPaper({
      maxQuestions: 5,
      title: 'æµ‹è¯•è¯•å·'
    });
    console.log('æµ‹è¯•æˆåŠŸ:', result);
  } catch (error) {
    console.error('æµ‹è¯•å¤±è´¥:', error);
  }
};
```

### 8.3 å¸¸è§é—®é¢˜æ’æŸ¥

#### é—®é¢˜1: PDFä¸­æ–‡æ˜¾ç¤ºä¸ºæ–¹æ¡†
**åŸå› **: å­—ä½“æœªæ­£ç¡®æ³¨å†Œ
**è§£å†³**:
```bash
# æ£€æŸ¥å­—ä½“æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la C:/Windows/Fonts/simsun.ttc

# åç«¯æ—¥å¿—æŸ¥çœ‹
# åº”è¯¥çœ‹åˆ°: âœ… æˆåŠŸæ³¨å†Œä¸­æ–‡å­—ä½“: SimSun
```

#### é—®é¢˜2: å‰ç«¯æ— æ³•ä¸‹è½½PDF
**åŸå› **: æ–‡ä»¶æƒé™æˆ–ç½‘ç»œé—®é¢˜
**æ’æŸ¥**:
1. æ£€æŸ¥åç«¯APIæ˜¯å¦æ­£å¸¸è¿”å›
2. æŸ¥çœ‹å‰ç«¯ç½‘ç»œè¯·æ±‚æ˜¯å¦æˆåŠŸ
3. æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿæƒé™
```typescript
console.log('FileSystem.documentDirectory:', FileSystem.documentDirectory);
```

#### é—®é¢˜3: é¢˜ç›®æå–ä¸ºç©º
**åŸå› **: å†å²è®°å½•æ ¼å¼ä¸åŒ¹é…
**æ’æŸ¥**:
```python
# åœ¨ extract_similar_questions_from_history ä¸­æ·»åŠ è°ƒè¯•
logger.info(f"å†å²è®°å½•ç»“æ„: {json.dumps(record, indent=2, ensure_ascii=False)}")
```

---

## ğŸ“š ä¹ã€å­¦ä¹ èµ„æº

### 9.1 æŠ€æœ¯æ–‡æ¡£
- **ReportLabå®˜æ–¹æ–‡æ¡£**: https://docs.reportlab.com/
- **React Nativeæ–‡æ¡£**: https://reactnative.dev/
- **Expo File System**: https://docs.expo.dev/versions/latest/sdk/filesystem/
- **Flaskæ–‡æ¡£**: https://flask.palletsprojects.com/

### 9.2 ç›¸å…³æŠ€æœ¯æ ˆ
- **TypeScript**: å‰ç«¯ç±»å‹ç³»ç»Ÿ
- **Python**: åç«¯è¯­è¨€
- **PDFç”Ÿæˆ**: ReportLabåº“
- **æ–‡ä»¶æ“ä½œ**: Expo SDK

### 9.3 æ¨èé˜…è¯»
1. ã€ŠPDF Reference 1.7ã€‹- PDFæ ¼å¼è§„èŒƒ
2. ReportLab User Guide - PDFç”Ÿæˆè¯¦è§£
3. Unicodeæ ‡å‡†æ–‡æ¡£ - å­—ç¬¦ç¼–ç 

---

## âœ… åã€éªŒæ”¶æ ‡å‡†

### 10.1 ä»»åŠ¡1éªŒæ”¶æ ‡å‡†
- [ ] é¢˜ç›®å†…å®¹æ¢è¡Œåˆç†ï¼Œæ— æˆªæ–­å•è¯ç°è±¡
- [ ] é¢˜ç›®ä¹‹é—´é—´è·å‡åŒ€ï¼Œè§†è§‰æ•ˆæœè‰¯å¥½
- [ ] ç­”é¢˜åŒºåŸŸå¤§å°åˆç†ï¼Œç¬¦åˆå®é™…ä½¿ç”¨éœ€æ±‚
- [ ] å¤šé¡µè¯•å·æ¢é¡µä½ç½®åˆç†ï¼Œæ— é¢˜ç›®æ–­è£‚
- [ ] ç”Ÿæˆ5ã€10ã€15ã€20é¢˜çš„è¯•å·å‡æ­£å¸¸
- [ ] æ‰“å°å®é™…PDFï¼Œæ’ç‰ˆæ¸…æ™°ç¾è§‚

### 10.2 ä»»åŠ¡2éªŒæ”¶æ ‡å‡†
- [ ] å¸¸è§æ•°å­¦ç¬¦å·æ­£ç¡®æ˜¾ç¤ºï¼ˆè‡³å°‘90%ï¼‰
- [ ] å¸Œè…Šå­—æ¯æ­£ç¡®æ˜¾ç¤º
- [ ] ä¸Šä¸‹æ ‡æ ¼å¼æ­£ç¡®ï¼ˆæˆ–æœ‰åˆç†æ›¿ä»£ï¼‰
- [ ] åŒ–å­¦å¼ã€ç‰©ç†å…¬å¼æ˜¾ç¤ºæ­£ç¡®
- [ ] Windowså’ŒLinuxç³»ç»Ÿå‡å¯æ­£å¸¸ç”Ÿæˆ
- [ ] æä¾›ä¸æ”¯æŒç¬¦å·çš„æ›¿ä»£æ–¹æ¡ˆ
- [ ] ç¼–å†™ç¬¦å·æ”¯æŒæ–‡æ¡£

### 10.3 ä»£ç è´¨é‡æ ‡å‡†
- [ ] ä»£ç æœ‰æ¸…æ™°çš„æ³¨é‡Šï¼ˆä¸­æ–‡ï¼‰
- [ ] å‡½æ•°å’Œå˜é‡å‘½åè§„èŒƒ
- [ ] æ— æ˜æ˜¾æ€§èƒ½é—®é¢˜
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] éµå¾ªé¡¹ç›®ç°æœ‰ä»£ç é£æ ¼

---

## ğŸ“ åä¸€ã€è·å–å¸®åŠ©

### 11.1 é‡åˆ°é—®é¢˜æ—¶
1. **å…ˆè‡ªå·±å°è¯•è§£å†³**
   - æŸ¥çœ‹é”™è¯¯æ—¥å¿—
   - æœç´¢ç›¸å…³æ–‡æ¡£
   - æµ‹è¯•ä¸åŒåœºæ™¯

2. **è®°å½•é—®é¢˜**
   - è¯¦ç»†æè¿°é—®é¢˜ç°è±¡
   - è®°å½•é”™è¯¯ä¿¡æ¯
   - æˆªå›¾æˆ–ä¿å­˜æ—¥å¿—

3. **å¯»æ±‚å¸®åŠ©**
   - å‘å­¦é•¿/å¯¼å¸ˆå’¨è¯¢
   - æŸ¥çœ‹ç›¸å…³GitHub Issues
   - åœ¨å›¢é˜Ÿç¾¤ä¸­è®¨è®º

### 11.2 ä»£ç å®¡æŸ¥
å®Œæˆä»»åŠ¡åï¼Œè¯·æäº¤ä»£ç ä¾›å®¡æŸ¥ï¼š
1. ç¡®ä¿ä»£ç å¯è¿è¡Œ
2. æä¾›æµ‹è¯•ç”¨ä¾‹
3. ç¼–å†™ç®€çŸ­çš„æ”¹è¿›è¯´æ˜
4. é™„ä¸Šæµ‹è¯•æ•ˆæœæˆªå›¾


